{"version":3,"file":"js/1886.d8628ec5.js","mappings":"kLACOA,GAAG,mB,0CAARC,EAAAA,EAAAA,IAAgC,MAAhCC,E,mJAMF,MAAMC,EAAaC,EAAQ,OAE3B,OACEC,UACEC,KAAKC,MACP,EACAC,QAAS,CACPD,OACE,IAAIE,EAAS,IAAIC,EAAAA,EAAc,mBAC3BA,EAAAA,EAAAA,oCAEFD,EAAOE,gBAAkBC,OAAOC,kBAElCJ,EAAOK,MAAMC,kBAAkBC,KAAKC,SAAU,EAE9C,MAAMC,EAAUf,EAAWgB,SAAS,GAC9BC,EAAcF,EAAQG,SAASD,YAErC,IAAIC,EAAW,IAAIX,EAAAA,EAAwB,CACzCY,UAAWZ,EAAAA,EAAAA,iBAAmCU,EAAYG,KAAK,IAC/DC,MAAO,KAGT,MAAMC,EAAW,IAAIf,EAAAA,EAAwB,CAC3CW,SAAUA,IAENK,EAAa,IAAIhB,EAAAA,EAAiB,CACtCiB,kBAAmBF,EACnBG,WAAY,IAAIlB,EAAAA,EAAkC,CAChDmB,SAAU,IAAInB,EAAAA,EAAgB,CAC5BoB,OAAQ,CACNC,KAAM,gBACNC,SAAU,CACRC,MAAO,IAAIvB,EAAAA,EAAa,GAAK,GAAK,GAAK,GACvCwB,UAAW,IACXC,WAAY,GAEdC,OAAQ,0iCA4BdC,cAAc,IAGVC,EAAW,IAAI5B,EAAAA,EAAwB,CAC3CW,SAAU,IAAIX,EAAAA,EAAuB,CACnC6B,iBAAkB,IAAI7B,EAAAA,EACpBA,EAAAA,EAAAA,iBAAmC,CACjC,GAAI,GAAI,GAAI,GAAI,IAAK,GAAI,IAAK,KAEhC,CAAC,IAAIA,EAAAA,EACHA,EAAAA,EAAAA,iBAAmCU,EAAYG,KAAK,WAMtDiB,EAAO,IAAI9B,EAAAA,EAAuB,CACtCiB,kBAAmBW,EACnBV,WAAY,IAAIlB,EAAAA,EAA0B,CACxCmB,SAAU,IAAInB,EAAAA,EAAgB,CAC5BoB,OAAQ,CACNC,KAAM,QACNC,SAAU,CACRC,MAAOvB,EAAAA,EAAAA,MAAAA,UAA6B,UAK5C2B,cAAc,IAGhB5B,EAAOK,MAAM2B,WAAWC,IAAIhB,GAC5BjB,EAAOK,MAAM2B,WAAWC,IAAIF,GAE5B/B,EAAOkC,OAAOC,oBAAoBlC,EAAAA,EAAAA,eAAuCW,GAAUwB,eAAgB,CAAEC,SAAU,GACjH,I,WCpGJ,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://webgis/./src/components/public/border_mask.vue","webpack://webgis/./src/components/public/border_mask.vue?7be0"],"sourcesContent":["<template>\n  <div id=\"cesiumContainer\"></div>\n</template>\n\n<script>\nimport 'cesium/Build/Cesium/Widgets/widgets.css'\nimport * as Cesium from 'cesium'\nconst borderJson = require('../../../public/SampleData/sichuan.json')\n\nexport default {\n  mounted() {\n    this.init()\n  },\n  methods: {\n    init() {\n      var viewer = new Cesium.Viewer('cesiumContainer')\n      if (Cesium.FeatureDetection.supportsImageRenderingPixelated()) {\n        //判断是否支持图像渲染像素化处理\n        viewer.resolutionScale = window.devicePixelRatio\n      }\n      viewer.scene.postProcessStages.fxaa.enabled = true\n\n      const feature = borderJson.features[0]\n      const coordinates = feature.geometry.coordinates\n\n      let geometry = new Cesium.PolylineGeometry({\n        positions: Cesium.Cartesian3.fromDegreesArray(coordinates.flat(2)),\n        width: 10.0\n      })\n\n      const instance = new Cesium.GeometryInstance({\n        geometry: geometry\n      })\n      const glowBorder = new Cesium.Primitive({\n        geometryInstances: instance,\n        appearance: new Cesium.PolylineMaterialAppearance({\n          material: new Cesium.Material({\n            fabric: {\n              type: 'MyBorderColor',\n              uniforms: {\n                color: new Cesium.Color(0.2, 0.2, 0.8, 1.0),\n                glowPower: 0.25,\n                taperPower: 1\n              },\n              source: `\n                  uniform vec4 color;\n                  uniform float glowPower;\n                  uniform float taperPower;\n                  czm_material czm_getMaterial(czm_materialInput materialInput)\n                  {\n                    czm_material material = czm_getDefaultMaterial(materialInput);\n                    vec2 st = materialInput.st;\n                    float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n\n                    if (taperPower <= 0.99999) {\n                        glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));\n                    }\n\n                    vec4 fragColor;\n                    fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n                    fragColor.a = clamp(0.0, 1.0, glow) * color.a;\n                    fragColor = czm_gammaCorrect(fragColor);\n\n                    material.emission = fragColor.rgb;\n                    material.alpha = fragColor.a;\n\n                    return material;\n                  }\n                `\n            }\n          })\n        }),\n        allowPicking: false\n      })\n\n      const maskArea = new Cesium.GeometryInstance({\n        geometry: new Cesium.PolygonGeometry({\n          polygonHierarchy: new Cesium.PolygonHierarchy(\n            Cesium.Cartesian3.fromDegreesArray([\n              45, 10, 45, 60, 145, 60, 145, 10\n            ]),\n            [new Cesium.PolygonHierarchy(\n              Cesium.Cartesian3.fromDegreesArray(coordinates.flat(2))\n            )]\n          )\n        }),\n      })\n\n      const mask = new Cesium.GroundPrimitive({\n        geometryInstances: maskArea,\n        appearance: new Cesium.MaterialAppearance({\n          material: new Cesium.Material({\n            fabric: {\n              type: 'Color',\n              uniforms: {\n                color: Cesium.Color.BLACK.withAlpha(0.7),\n              }\n            }\n          })\n        }),\n        allowPicking: false\n      })\n\n      viewer.scene.primitives.add(glowBorder)\n      viewer.scene.primitives.add(mask)\n\n      viewer.camera.flyToBoundingSphere(Cesium.PolylineGeometry.createGeometry(geometry).boundingSphere, { duration: 0 })\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n#cesiumContainer {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n}\n</style>\n","import { render } from \"./border_mask.vue?vue&type=template&id=90babab6&scoped=true\"\nimport script from \"./border_mask.vue?vue&type=script&lang=js\"\nexport * from \"./border_mask.vue?vue&type=script&lang=js\"\n\nimport \"./border_mask.vue?vue&type=style&index=0&id=90babab6&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhengjie/Documents/webgis/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-90babab6\"]])\n\nexport default __exports__"],"names":["id","_createElementBlock","_hoisted_1","borderJson","require","mounted","this","init","methods","viewer","Cesium","resolutionScale","window","devicePixelRatio","scene","postProcessStages","fxaa","enabled","feature","features","coordinates","geometry","positions","flat","width","instance","glowBorder","geometryInstances","appearance","material","fabric","type","uniforms","color","glowPower","taperPower","source","allowPicking","maskArea","polygonHierarchy","mask","primitives","add","camera","flyToBoundingSphere","boundingSphere","duration","__exports__","render"],"sourceRoot":""}