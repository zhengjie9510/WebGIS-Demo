"use strict";(self["webpackChunkwebgis"]=self["webpackChunkwebgis"]||[]).push([[588],{28588:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(73396);const a=e=>((0,r.dD)("data-v-015ca138"),e=e(),(0,r.Cn)(),e),i={class:"container"},o=a((()=>(0,r._)("div",{id:"cesiumContainer"},null,-1))),s=a((()=>(0,r._)("canvas",{id:"threeContainer"},null,-1))),c=[o,s];function l(e,t,n,a,o,s){return(0,r.wg)(),(0,r.iD)("div",i,c)}n(57658);var d=n(42891),h=n(86821),u=n(63822),m=n(64680),w=n(65733),v=n(11114),p=n(3676);const f={viewer:null},g={renderer:null,camera:null,scene:null};let x=[115.23,39.55],S=[116.23,41.55];const D=[];function y(){this.threeMesh=null,this.minWGS84=null,this.maxWGS84=null}var R={mounted(){this.init()},methods:{init(){this.initCesium(),this.initThreejs(),this.init3DObject(),this.startRenderLoop()},initCesium(){f.viewer=new d.Z("cesiumContainer",{useDefaultRenderLoop:!1,selectionIndicator:!1,infoBox:!1,navigationInstructionsInitiallyVisible:!1,fullscreenButton:!1,allowTextureFilterAnisotropic:!1,contextOptions:{webgl:{alpha:!1,antialias:!0,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!1,depth:!0,stencil:!1,anialias:!1}},targetFrameRate:60,resolutionScale:.1,orderIndependentTranslucency:!0,imageryProvider:void 0,baseLayerPicker:!1,automaticallyTrackDataSourceClocks:!1,dataSources:null,clock:null,terrainShadows:h.Z.DISABLED});const e=u.Z.fromDegrees((x[0]+S[0])/2,(x[1]+S[1])/2-1,2e5);f.viewer.camera.flyTo({destination:e,orientation:{heading:m.Z.toRadians(0),pitch:m.Z.toRadians(-60),roll:m.Z.toRadians(0)},duration:3})},initThreejs(){const e=document.querySelector("#threeContainer"),t=new v.CP7({canvas:e,alpha:!0,logarithmicDepthBuffer:!0,antialias:!0});var n=45,r=e.clientWidth,a=e.clientHeight,i=r/a,o=1,s=1e7;const c=new v.cPb(n,i,o,s),l=new v.xsS;g.renderer=t,g.scene=l,g.camera=c},init3DObject(){const e={name:"Polygon",polygon:{hierarchy:u.Z.fromDegreesArray([x[0],x[1],S[0],x[1],S[0],S[1],x[0],S[1]]),material:w.Z.RED.withAlpha(.2)}};f.viewer.entities.add(e);for(var t=new v.RSm({side:v.ehD}),n=10,r=[],a=0;a<n;a++)r.push(new v.FM8(Math.sin(.2*a)*n+5,2*(a-5)));var i=new v.p7y(r),o=new v.Kj0(i,t);o.scale.set(1500,1500,1500),o.position.z+=15e3,o.rotation.x=Math.PI/2;var s=new v.ZAu;s.add(o),g.scene.add(s);var c=new y;c.threeMesh=s,c.minWGS84=x,c.maxWGS84=S,D.push(c),i=new v.Kgo;var l=new v.Kj0(i,new v.RSm);l.scale.set(1e4,1e4,1e4),l.position.z+=1e4,l.rotation.x=Math.PI/2;var d=new v.ZAu;d.add(l),g.scene.add(d),c=new y,c.threeMesh=d,c.minWGS84=x,c.maxWGS84=S,D.push(c);for(const h in D){x=D[h].minWGS84,S=D[h].maxWGS84;const e=u.Z.fromDegrees((x[0]+S[0])/2,(x[1]+S[1])/2),t=u.Z.fromDegrees((x[0]+S[0])/2,(x[1]+S[1])/2,1);console.log(t),D[h].threeMesh.position.copy(e),D[h].threeMesh.lookAt(t.x,t.y,t.z)}},threeRender(){g.camera.matrixAutoUpdate=!1;const e=f.viewer.camera.viewMatrix,t=f.viewer.camera.inverseViewMatrix;g.camera.lookAt(0,0,0),g.camera.matrixWorld.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]),g.camera.matrixWorldInverse.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]);const n=g.renderer.domElement;g.renderer.setPixelRatio(window.devicePixelRatio);const r=n.clientWidth,a=n.clientHeight,i=n.width!==r||n.height!==a;i&&g.renderer.setSize(r,a,!1),g.camera.aspect=r/a,g.camera.fov=m.Z.toDegrees(f.viewer.camera.frustum.fovy),g.camera.updateProjectionMatrix(),g.renderer.render(g.scene,g.camera)},startRenderLoop(){(0,p.requestAnimationFrame)(this.startRenderLoop),f.viewer.render(),this.threeRender()}}},Z=n(40089);const M=(0,Z.Z)(R,[["render",l],["__scopeId","data-v-015ca138"]]);var C=M}}]);
//# sourceMappingURL=588.160c962a.js.map