"use strict";(self["webpackChunkwebgis"]=self["webpackChunkwebgis"]||[]).push([[228],{2348:function(e,t,n){n.d(t,{Z:function(){return Te}});n(7658);var r=n(8408),o=n(3822),i=n(5733),s=n(4142),l=n(8278),c=n(8798),u=n(6114),a=n(938),f=n(1496),h=n(3261);function p(e){if(!(0,u.Z)(e))throw new a.Z("uri is required.");const t=new h(e);t.normalize();let n=t.path();const r=n.lastIndexOf("/");return-1!==r&&(n=n.substr(r+1)),n}var d=p,Z=n(6282),g=n(6214),m=n(4730);function w(){this._cache={}}w.prototype.fromColor=function(e,t){if(!(0,u.Z)(e))throw new a.Z("color is required");if(!(0,u.Z)(t))throw new a.Z("size is required");return _(void 0,void 0,e,t,this._cache)},w.prototype.fromUrl=function(e,t,n){if(!(0,u.Z)(e))throw new a.Z("url is required");if(!(0,u.Z)(t))throw new a.Z("color is required");if(!(0,u.Z)(n))throw new a.Z("size is required");return _(e,void 0,t,n,this._cache)},w.prototype.fromMakiIconId=function(e,t,n){if(!(0,u.Z)(e))throw new a.Z("id is required");if(!(0,u.Z)(t))throw new a.Z("color is required");if(!(0,u.Z)(n))throw new a.Z("size is required");return _((0,Z.Z)(`Assets/Textures/maki/${encodeURIComponent(e)}.png`),void 0,t,n,this._cache)},w.prototype.fromText=function(e,t,n){if(!(0,u.Z)(e))throw new a.Z("text is required");if(!(0,u.Z)(t))throw new a.Z("color is required");if(!(0,u.Z)(n))throw new a.Z("size is required");return _(void 0,e,t,n,this._cache)};const y=new i.Z;function C(e,t,n){e.save(),e.scale(n/24,n/24),e.fillStyle=t.toCssColorString(),e.strokeStyle=t.brighten(.6,y).toCssColorString(),e.lineWidth=.846,e.beginPath(),e.moveTo(6.72,.422),e.lineTo(17.28,.422),e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),e.lineTo(19.577,10.973),e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),e.lineTo(14.386,14.008),e.lineTo(11.826,23.578),e.lineTo(9.614,14.008),e.lineTo(6.719,13.965),e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),e.lineTo(4.422,3.416),e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),e.closePath(),e.fill(),e.stroke(),e.restore()}function k(e,t,n){const r=n/2.5;let o=r,s=r;t.width>t.height?s=r*(t.height/t.width):t.width<t.height&&(o=r*(t.width/t.height));const l=Math.round((n-o)/2),c=Math.round(7/24*n-s/2);e.globalCompositeOperation="destination-out",e.drawImage(t,l-1,c,o,s),e.drawImage(t,l,c-1,o,s),e.drawImage(t,l+1,c,o,s),e.drawImage(t,l,c+1,o,s),e.globalCompositeOperation="destination-over",e.fillStyle=i.Z.BLACK.toCssColorString(),e.fillRect(l-1,c-1,o+2,s+2),e.globalCompositeOperation="destination-out",e.drawImage(t,l,c,o,s),e.globalCompositeOperation="destination-over",e.fillStyle=i.Z.WHITE.toCssColorString(),e.fillRect(l-1,c-2,o+2,s+2)}const b=new Array(4);function _(e,t,n,r,o){b[0]=e,b[1]=t,b[2]=n,b[3]=r;const i=JSON.stringify(b),s=o[i];if((0,u.Z)(s))return s;const l=document.createElement("canvas");l.width=r,l.height=r;const c=l.getContext("2d");if(C(c,n,r),(0,u.Z)(e)){const t=g.Z.createIfNeeded(e),n=t.fetchImage().then((function(e){return k(c,e,r),o[i]=l,l}));return o[i]=n,n}if((0,u.Z)(t)){const e=(0,m.Z)(t,{font:`bold ${r}px sans-serif`});k(c,e,r)}return o[i]=l,l}var v=w,P=n(7730),S=n(6446),T=n(1104),M=n(4109);function O(e,t){var n,r=e.length,o=r-t;while(o<--r)n=e[o],e[o++]=e[r],e[r]=n}function L(e){return e}function E(e){if(null==e)return L;var t,n,r=e.scale[0],o=e.scale[1],i=e.translate[0],s=e.translate[1];return function(e,l){l||(t=n=0);var c=2,u=e.length,a=new Array(u);a[0]=(t+=e[0])*r+i,a[1]=(n+=e[1])*o+s;while(c<u)a[c]=e[c],++c;return a}}function G(e,t){return"string"===typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return U(e,t)}))}:U(e,t)}function U(e,t){var n=t.id,r=t.bbox,o=null==t.properties?{}:t.properties,i=$(e,t);return null==n&&null==r?{type:"Feature",properties:o,geometry:i}:null==r?{type:"Feature",id:n,properties:o,geometry:i}:{type:"Feature",id:n,bbox:r,properties:o,geometry:i}}function $(e,t){var n=E(e.transform),r=e.arcs;function o(e,t){t.length&&t.pop();for(var o=r[e<0?~e:e],i=0,s=o.length;i<s;++i)t.push(n(o[i],i));e<0&&O(t,s)}function i(e){return n(e)}function s(e){for(var t=[],n=0,r=e.length;n<r;++n)o(e[n],t);return t.length<2&&t.push(t[0]),t}function l(e){var t=s(e);while(t.length<4)t.push(t[0]);return t}function c(e){return e.map(l)}function u(e){var t,n=e.type;switch(n){case"GeometryCollection":return{type:n,geometries:e.geometries.map(u)};case"Point":t=i(e.coordinates);break;case"MultiPoint":t=e.coordinates.map(i);break;case"LineString":t=s(e.arcs);break;case"MultiLineString":t=e.arcs.map(s);break;case"Polygon":t=c(e.arcs);break;case"MultiPolygon":t=e.arcs.map(c);break;default:return null}return{type:n,coordinates:t}}return u(t)}n(541);var I=n(160),z=n(9632),q=n(893),B=n(8718),x=n(2139),A=n(2194),R=n(723),W=n(7471),j=n(9707),N=n(611);function F(e){return o.Z.fromDegrees(e[0],e[1],e[2])}const H={"urn:ogc:def:crs:OGC:1.3:CRS84":F,"EPSG:4326":F,"urn:ogc:def:crs:EPSG::4326":F},J={},V={};let Y,D=48,K=i.Z.ROYALBLUE,X=i.Z.YELLOW,Q=2,ee=i.Z.fromBytes(255,255,0,100),te=!1;const ne={small:24,medium:48,large:64},re=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function oe(e,t){let n="";for(const r in e)if(e.hasOwnProperty(r)){if(r===t||-1!==re.indexOf(r))continue;const o=e[r];(0,u.Z)(o)&&(n+="object"===typeof o?`<tr><th>${r}</th><td>${oe(o)}</td></tr>`:`<tr><th>${r}</th><td>${o}</td></tr>`)}return n.length>0&&(n=`<table class="cesium-infoBox-defaultTable"><tbody>${n}</tbody></table>`),n}function ie(e,t,n){let r;return function(o,i){return(0,u.Z)(r)||(r=e(t,n)),r}}function se(e,t){return new z.Z(ie(oe,e,t),!0)}function le(e,t,n){let r=e.id;if((0,u.Z)(r)&&"Feature"===e.type){let e=2,n=r;while((0,u.Z)(t.getById(n)))n=`${r}_${e}`,e++;r=n}else r=(0,s.Z)();const o=t.getOrCreateEntity(r),i=e.properties;if((0,u.Z)(i)){let e;o.properties=i;const t=i.title;if((0,u.Z)(t))o.name=t,e="title";else{let t=Number.MAX_VALUE;for(const n in i)if(i.hasOwnProperty(n)&&i[n]){const r=n.toLowerCase();if(t>1&&"title"===r){t=1,e=n;break}t>2&&"name"===r?(t=2,e=n):t>3&&/title/i.test(n)?(t=3,e=n):t>4&&/name/i.test(n)&&(t=4,e=n)}(0,u.Z)(e)&&(o.name=i[e])}const r=i.description;null!==r&&(o.description=(0,u.Z)(r)?new x.Z(r):n(i,e))}return o}function ce(e,t){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t(e[r]);return n}const ue={Feature:fe,FeatureCollection:he,GeometryCollection:pe,LineString:we,MultiLineString:ye,MultiPoint:ge,MultiPolygon:be,Point:Ze,Polygon:ke,Topology:_e},ae={GeometryCollection:pe,LineString:we,MultiLineString:ye,MultiPoint:ge,MultiPolygon:be,Point:Ze,Polygon:ke,Topology:_e};function fe(e,t,n,r,o){if(null===t.geometry)return void le(t,e._entityCollection,o.describe);if(!(0,u.Z)(t.geometry))throw new S.Z("feature.geometry is required.");const i=t.geometry.type,s=ae[i];if(!(0,u.Z)(s))throw new S.Z(`Unknown geometry type: ${i}`);s(e,t,t.geometry,r,o)}function he(e,t,n,r,o){const i=t.features;for(let s=0,l=i.length;s<l;s++)fe(e,i[s],void 0,r,o)}function pe(e,t,n,r,o){const i=n.geometries;for(let s=0,l=i.length;s<l;s++){const n=i[s],l=n.type,c=ae[l];if(!(0,u.Z)(c))throw new S.Z(`Unknown geometry type: ${l}`);c(e,t,n,r,o)}}function de(e,t,n,r,o){let s=o.markerSymbol,l=o.markerColor,a=o.markerSize;const f=t.properties;if((0,u.Z)(f)){const e=f["marker-color"];(0,u.Z)(e)&&(l=i.Z.fromCssColorString(e)),a=(0,c.Z)(ne[f["marker-size"]],a);const t=f["marker-symbol"];(0,u.Z)(t)&&(s=t)}let h;h=(0,u.Z)(s)?1===s.length?e._pinBuilder.fromText(s.toUpperCase(),l,a):e._pinBuilder.fromMakiIconId(s,l,a):e._pinBuilder.fromColor(l,a);const p=new I.Z;p.verticalOrigin=new x.Z(M.Z.BOTTOM),2===r.length&&o.clampToGround&&(p.heightReference=T.Z.CLAMP_TO_GROUND);const d=le(t,e._entityCollection,o.describe);d.billboard=p,d.position=new B.Z(n(r));const Z=Promise.resolve(h).then((function(e){p.image=new x.Z(e)})).catch((function(){p.image=new x.Z(e._pinBuilder.fromColor(l,a))}));e._promises.push(Z)}function Ze(e,t,n,r,o){de(e,t,r,n.coordinates,o)}function ge(e,t,n,r,o){const i=n.coordinates;for(let s=0;s<i.length;s++)de(e,t,r,i[s],o)}function me(e,t,n,o,s){let l=s.strokeMaterialProperty,c=s.strokeWidthProperty;const a=t.properties;if((0,u.Z)(a)){const e=a["stroke-width"];let t;(0,u.Z)(e)&&(c=new x.Z(e));const n=a.stroke;(0,u.Z)(n)&&(t=i.Z.fromCssColorString(n));const r=a["stroke-opacity"];(0,u.Z)(r)&&1!==r&&((0,u.Z)(t)||(t=l.color.getValue().clone()),t.alpha=r),(0,u.Z)(t)&&(l=new q.Z(t))}const f=le(t,e._entityCollection,s.describe),h=new N.Z;f.polyline=h,h.clampToGround=s.clampToGround,h.material=l,h.width=c,h.positions=new x.Z(ce(o,n)),h.arcType=r.Z.RHUMB}function we(e,t,n,r,o){me(e,t,r,n.coordinates,o)}function ye(e,t,n,r,o){const i=n.coordinates;for(let s=0;s<i.length;s++)me(e,t,r,i[s],o)}function Ce(e,t,n,o,s){if(0===o.length||0===o[0].length)return;let l=s.strokeMaterialProperty.color,c=s.fillMaterialProperty,a=s.strokeWidthProperty;const f=t.properties;if((0,u.Z)(f)){const e=f["stroke-width"];let t;(0,u.Z)(e)&&(a=new x.Z(e));const n=f.stroke;(0,u.Z)(n)&&(t=i.Z.fromCssColorString(n));let r,o=f["stroke-opacity"];(0,u.Z)(o)&&1!==o&&((0,u.Z)(t)||(t=l.getValue().clone()),t.alpha=o),(0,u.Z)(t)&&(l=new x.Z(t));const s=f.fill,h=c.color.getValue();(0,u.Z)(s)&&(r=i.Z.fromCssColorString(s),r.alpha=h.alpha),o=f["fill-opacity"],(0,u.Z)(o)&&o!==h.alpha&&((0,u.Z)(r)||(r=h.clone()),r.alpha=o),(0,u.Z)(r)&&(c=new q.Z(r))}const h=new j.Z;h.outline=new x.Z(!0),h.outlineColor=l,h.outlineWidth=a,h.material=c,h.arcType=r.Z.RHUMB;const p=[];for(let r=1,i=o.length;r<i;r++)p.push(new P.Z(ce(o[r],n)));const d=o[0];h.hierarchy=new x.Z(new P.Z(ce(d,n),p)),d[0].length>2?h.perPositionHeight=new x.Z(!0):s.clampToGround||(h.height=0);const Z=le(t,e._entityCollection,s.describe);Z.polygon=h}function ke(e,t,n,r,o){Ce(e,t,r,n.coordinates,o)}function be(e,t,n,r,o){const i=n.coordinates;for(let s=0;s<i.length;s++)Ce(e,t,r,i[s],o)}function _e(e,t,n,r,o){for(const i in n.objects)if(n.objects.hasOwnProperty(i)){const t=G(n,n.objects[i]),s=ue[t.type];s(e,t,t,r,o)}}function ve(e){this._name=e,this._changed=new f.Z,this._error=new f.Z,this._isLoading=!1,this._loading=new f.Z,this._entityCollection=new W.Z(this),this._promises=[],this._pinBuilder=new v,this._entityCluster=new R.Z,this._credit=void 0,this._resourceCredits=[]}function Pe(e,t,n,r){if(!(0,u.Z)(t))throw new a.Z("data is required.");A.Z.setLoading(e,!0),n=(0,c.Z)(n,c.Z.EMPTY_OBJECT);let o=n.credit;"string"===typeof o&&(o=new l.Z(o)),e._credit=o;let i=t,s=n.sourceUri;if("string"===typeof t||t instanceof g.Z){t=g.Z.createIfNeeded(t),i=t.fetchJson(),s=(0,c.Z)(s,t.getUrlComponent());const n=e._resourceCredits,r=t.credits;if((0,u.Z)(r)){const e=r.length;for(let t=0;t<e;t++)n.push(r[t])}}return n={describe:(0,c.Z)(n.describe,se),markerSize:(0,c.Z)(n.markerSize,D),markerSymbol:(0,c.Z)(n.markerSymbol,Y),markerColor:(0,c.Z)(n.markerColor,K),strokeWidthProperty:new x.Z((0,c.Z)(n.strokeWidth,Q)),strokeMaterialProperty:new q.Z((0,c.Z)(n.stroke,X)),fillMaterialProperty:new q.Z((0,c.Z)(n.fill,ee)),clampToGround:(0,c.Z)(n.clampToGround,te)},Promise.resolve(i).then((function(t){return Se(e,t,n,s,r)})).catch((function(t){throw A.Z.setLoading(e,!1),e._error.raiseEvent(e,t),t}))}function Se(e,t,n,r,o){let i;(0,u.Z)(r)&&(i=d(r)),(0,u.Z)(i)&&e._name!==i&&(e._name=i,e._changed.raiseEvent(e));const s=ue[t.type];if(!(0,u.Z)(s))throw new S.Z(`Unsupported GeoJSON object type: ${t.type}`);const l=t.crs;let c=null!==l?F:null;if((0,u.Z)(l)){if(!(0,u.Z)(l.properties))throw new S.Z("crs.properties is undefined.");const e=l.properties;if("name"===l.type){if(c=H[e.name],!(0,u.Z)(c))throw new S.Z(`Unknown crs name: ${e.name}`)}else if("link"===l.type){let t=J[e.href];if((0,u.Z)(t)||(t=V[e.type]),!(0,u.Z)(t))throw new S.Z(`Unable to resolve crs link: ${JSON.stringify(e)}`);c=t(e)}else{if("EPSG"!==l.type)throw new S.Z(`Unknown crs type: ${l.type}`);if(c=H[`EPSG:${e.code}`],!(0,u.Z)(c))throw new S.Z(`Unknown crs EPSG code: ${e.code}`)}}return Promise.resolve(c).then((function(r){return o&&e._entityCollection.removeAll(),null!==r&&s(e,t,t,r,n),Promise.all(e._promises).then((function(){return e._promises.length=0,A.Z.setLoading(e,!1),e}))}))}ve.load=function(e,t){return(new ve).load(e,t)},Object.defineProperties(ve,{markerSize:{get:function(){return D},set:function(e){D=e}},markerSymbol:{get:function(){return Y},set:function(e){Y=e}},markerColor:{get:function(){return K},set:function(e){K=e}},stroke:{get:function(){return X},set:function(e){X=e}},strokeWidth:{get:function(){return Q},set:function(e){Q=e}},fill:{get:function(){return ee},set:function(e){ee=e}},clampToGround:{get:function(){return te},set:function(e){te=e}},crsNames:{get:function(){return H}},crsLinkHrefs:{get:function(){return J}},crsLinkTypes:{get:function(){return V}}}),Object.defineProperties(ve.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,u.Z)(e))throw new a.Z("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}}}),ve.prototype.load=function(e,t){return Pe(this,e,t,!0)},ve.prototype.process=function(e,t){return Pe(this,e,t,!1)},ve.prototype.update=function(e){return!0};var Te=ve}}]);
//# sourceMappingURL=228.aecc0851.js.map