{"version":3,"file":"js/9149.b14505f8.js","mappings":"wOACOA,MAAM,a,UAAYC,EAAAA,EAAAA,GAAwB,UAAhBC,GAAG,KAAG,W,GAAdC,G,0CAAvBC,EAAAA,EAAAA,IAAqD,MAArDC,EAAqD,E,gBAIvD,GACEC,UACEC,KAAKC,MACP,EACAC,QAAS,CACPD,OACE,MAAME,EAAQ,IAAIC,EAAAA,IAEZC,EAASC,SAASC,cAAc,MAChCC,EAAW,IAAIJ,EAAAA,IAAoB,CAAEC,WAC3CG,EAASC,QAAQJ,EAAOK,WAAYL,EAAOM,aAC3CH,EAASI,cAAcC,OAAOC,kBAE9B,MAAMC,EAAS,IAAIX,EAAAA,IACjB,GACAC,EAAOW,YAAcX,EAAOY,aAC5B,EACA,KAEFF,EAAOG,SAASC,EAAI,EAEpB,MAAMC,EAAqB,6KAOrBC,EAAuB,g2IA8HvBC,EAAW,IAAIlB,EAAAA,IAAoB,EAAG,GACtCmB,EAAW,IAAInB,EAAAA,IAAqB,CACxCoB,SAAU,CACRC,YAAa,CAAEC,MAAO,IAAItB,EAAAA,IAAcC,EAAOW,YAAaX,EAAOY,eACnEU,MAAO,CAAED,MAAO,IAElBE,aAAcR,EACdS,eAAgBR,IAElB,IAAIS,EAAQ,IAAI1B,EAAAA,IAAWkB,EAAUC,GAIrC,SAASQ,IACP,GAAIC,EAA4BxB,GAAW,CACzC,MAAMH,EAASG,EAASyB,WACxBlB,EAAOmB,OAAS7B,EAAOW,YAAcX,EAAOY,aAC5CF,EAAOoB,wBACT,CACA,IAAIC,EAAOC,sBAAsBN,GACjCD,EAAMQ,MAAMC,IAAI,KAAOlC,EAAOW,YAAcX,EAAOY,aAAc,KAAM,GACvEa,EAAMP,SAASC,SAASG,MAAQ,CAAED,MAAOU,EAAO,KAChDN,EAAMP,SAASC,SAASC,YAAc,CAAEC,MAAO,IAAItB,EAAAA,IAAcC,EAAOW,YAAaX,EAAOY,eAC5FT,EAASgC,OAAOrC,EAAOY,EACzB,CACA,SAASiB,EAA4BxB,GACnC,MAAMH,EAASG,EAASyB,WAClBQ,EAAQpC,EAAOW,YACf0B,EAASrC,EAAOY,aAChB0B,EAAatC,EAAOoC,QAAUA,GAASpC,EAAOqC,SAAWA,EAI/D,OAHIC,GACFnC,EAASC,QAAQgC,EAAOC,GAAQ,GAE3BC,CACT,CAxBAxC,EAAMyC,IAAId,GAEVC,GAuBF,I,WC3LJ,MAAMc,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASL,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://webgis/./src/components/three/fireworks_effect.vue","webpack://webgis/./src/components/three/fireworks_effect.vue?cf9b"],"sourcesContent":["<template>\r\n  <div class=\"container\"><canvas id=\"c\"></canvas></div>\r\n</template>\r\n<script>\r\nimport * as THREE from 'three'\r\nexport default {\r\n  mounted() {\r\n    this.init()\r\n  },\r\n  methods: {\r\n    init() {\r\n      const scene = new THREE.Scene()\r\n\r\n      const canvas = document.querySelector('#c')\r\n      const renderer = new THREE.WebGLRenderer({ canvas })\r\n      renderer.setSize(canvas.innerWidth, canvas.innerHeight)\r\n      renderer.setPixelRatio(window.devicePixelRatio)\r\n\r\n      const camera = new THREE.PerspectiveCamera(\r\n        60,\r\n        canvas.clientWidth / canvas.clientHeight,\r\n        1,\r\n        1000\r\n      )\r\n      camera.position.z = 4;\r\n\r\n      const vertexShaderSource = `\r\n        out vec2 st;\r\n        void main() {\r\n          st =uv;\r\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n        }\r\n        `\r\n      const fragmentShaderSource = `\r\n        #define SPARKS 30\r\n        #define FIREWORKS 8.\r\n        #define BASE_PAUSE FIREWORKS / 30.\r\n        #define PI 3.14\r\n        #define PI2 6.28\r\n        uniform vec2 iResolution;\r\n        uniform float iTime;\r\n\r\n        float n21(vec2 n) {\r\n            return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n        }\r\n\r\n        vec2 randomSpark(float noise) {\r\n            vec2 v0 = vec2((noise - .5) * 13., (fract(noise * 123.) - .5) * 15.);\r\n            return v0;\r\n        }\r\n\r\n        vec2 circularSpark(float i, float noiseId, float noiseSpark) {\r\n            noiseId = fract(noiseId * 7897654.45);\r\n            float a = (PI2 / float(SPARKS)) * i;\r\n            float speed = 10.*clamp(noiseId, .7, 1.);\r\n            float x = sin(a + iTime*((noiseId-.5)*3.));\r\n            float y = cos(a + iTime*(fract(noiseId*4567.332) - .5)*2.);\r\n            vec2 v0 = vec2(x, y) * speed;\r\n            return v0;\r\n        }\r\n\r\n\r\n        vec2 rocket(vec2 start, float t) {\r\n            float y = t;\r\n            float x = sin(y*10.+cos(t*3.))*.1;\r\n            vec2 p = start + vec2(x, y * 8.);\r\n            return p;\r\n        }\r\n\r\n        vec3 firework(vec2 uv, float index, float pauseTime) {\r\n            vec3 col = vec3(0.);\r\n\r\n\r\n            float timeScale = 1.;\r\n            vec2 gravity = vec2(0., -9.8);\r\n\r\n            float explodeTime = .9;\r\n            float rocketTime = 1.1;\r\n            float episodeTime = rocketTime + explodeTime + pauseTime;\r\n\r\n            float ratio = iResolution.x / iResolution.y;\r\n\r\n            float timeScaled = (iTime - pauseTime) / timeScale;\r\n\r\n            float id = floor(timeScaled / episodeTime);\r\n            float et = mod(timeScaled, episodeTime);\r\n\r\n            float noiseId = n21(vec2(id+1., index+1.));\r\n\r\n            float scale = clamp(fract(noiseId*567.53)*30., 10., 30.);\r\n            uv *= scale;\r\n\r\n            rocketTime -= (fract(noiseId*1234.543) * .5);\r\n\r\n            vec2 pRocket = rocket(vec2(0. + ((noiseId - .5)*scale*ratio), 0. - scale/2.), clamp(et, 0., rocketTime));\r\n\r\n            if (et < rocketTime) {\r\n                float rd = length(uv - pRocket);\r\n                col += pow(.05/rd , 1.9) * vec3(0.9, .3, .0);\r\n            }\r\n\r\n\r\n            if (et > rocketTime && et < (rocketTime + explodeTime)) {\r\n                float burst = sign(fract(noiseId*44432.22) - .6);\r\n                for(int i = 0 ; i < SPARKS ; i++) {\r\n                        vec2 center = pRocket;\r\n                        float fi = float(i);\r\n                        float noiseSpark = fract(n21(vec2(id*10.+index*20., float(i+1))) * 332.44);\r\n                        float t = et - rocketTime;\r\n                        vec2 v0;\r\n\r\n                        if (fract(noiseId*3532.33) > .5) {\r\n                            v0 = randomSpark(noiseSpark);\r\n                            t -= noiseSpark * (fract(noiseId*543.) * .2);\r\n                        } else {\r\n                            v0 = circularSpark(fi, noiseId, noiseSpark);\r\n\r\n                            if ( (fract(noiseId*973.22) - .5) > 0.) {\r\n                                float re = mod(fi, 4. + 10. * noiseId);\r\n                                t -= floor(re/2.) * burst * .1;\r\n                            } else {\r\n                                t -= mod(fi, 2.) == 0. ? 0. : burst * .5*clamp(noiseId, .3, 1.);\r\n                            }\r\n                        }\r\n\r\n                        vec2 s = v0*t + (gravity * t * t) / 2.;\r\n\r\n                        vec2 p = center + s;\r\n\r\n                        float d = length(uv - p);\r\n\r\n                        if (t > 0.) {\r\n                            float fade = clamp((1. - t/explodeTime), 0., 1.);\r\n                            vec3 sparkColor = vec3(noiseId*.9, .5*fract(noiseId *456.33), .5*fract(noiseId *1456.33));\r\n                            vec3 c = (.05 / d) * sparkColor;\r\n                            col += c * fade;\r\n                        }\r\n                    }\r\n            }\r\n\r\n            return col;\r\n        }\r\n\r\n        void main() {\r\n          vec4 fragCoords = gl_FragCoord;\r\n\r\n          vec2 uv = fragCoords.xy / iResolution.xy;\r\n          uv -= .5;\r\n          uv.x *= iResolution.x / iResolution.y;\r\n\r\n          vec3 col = vec3(0.);\r\n\r\n          for (float i = 0. ; i < FIREWORKS ; i += 1.) {\r\n              col += firework(uv, i + 1., (i * BASE_PAUSE));\r\n          }\r\n\r\n          gl_FragColor = vec4(col, 1.);\r\n        }\r\n        `\r\n      const geometry = new THREE.PlaneGeometry(1, 1);\r\n      const material = new THREE.ShaderMaterial({\r\n        uniforms: {\r\n          iResolution: { value: new THREE.Vector2(canvas.clientWidth, canvas.clientHeight) },\r\n          iTime: { value: 0 }\r\n        },\r\n        vertexShader: vertexShaderSource,\r\n        fragmentShader: fragmentShaderSource\r\n      })\r\n      let plane = new THREE.Mesh(geometry, material);\r\n      scene.add(plane);\r\n      \r\n      animate()\r\n      function animate() {\r\n        if (resizeRendererToDisplaySize(renderer)) {\r\n          const canvas = renderer.domElement\r\n          camera.aspect = canvas.clientWidth / canvas.clientHeight\r\n          camera.updateProjectionMatrix()\r\n        }\r\n        let time = requestAnimationFrame(animate)\r\n        plane.scale.set(4.61 * canvas.clientWidth / canvas.clientHeight, 4.61, 1)\r\n        plane.material.uniforms.iTime = { value: time / 100 }\r\n        plane.material.uniforms.iResolution = { value: new THREE.Vector2(canvas.clientWidth, canvas.clientHeight) }\r\n        renderer.render(scene, camera)\r\n      }\r\n      function resizeRendererToDisplaySize(renderer) {\r\n        const canvas = renderer.domElement\r\n        const width = canvas.clientWidth\r\n        const height = canvas.clientHeight\r\n        const needResize = canvas.width !== width || canvas.height !== height\r\n        if (needResize) {\r\n          renderer.setSize(width, height, false)\r\n        }\r\n        return needResize\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.container {\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n#c {\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n  margin: 0%;\r\n}\r\n</style>\r\n","import { render } from \"./fireworks_effect.vue?vue&type=template&id=1b7a02f0&scoped=true\"\nimport script from \"./fireworks_effect.vue?vue&type=script&lang=js\"\nexport * from \"./fireworks_effect.vue?vue&type=script&lang=js\"\n\nimport \"./fireworks_effect.vue?vue&type=style&index=0&id=1b7a02f0&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\Documents\\\\GitHub\\\\webgis\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1b7a02f0\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","id","_hoisted_2","_createElementBlock","_hoisted_1","mounted","this","init","methods","scene","THREE","canvas","document","querySelector","renderer","setSize","innerWidth","innerHeight","setPixelRatio","window","devicePixelRatio","camera","clientWidth","clientHeight","position","z","vertexShaderSource","fragmentShaderSource","geometry","material","uniforms","iResolution","value","iTime","vertexShader","fragmentShader","plane","animate","resizeRendererToDisplaySize","domElement","aspect","updateProjectionMatrix","time","requestAnimationFrame","scale","set","render","width","height","needResize","add","__exports__"],"sourceRoot":""}