import Check from"../../Core/Check.js";import defaultValue from"../../Core/defaultValue.js";import defined from"../../Core/defined.js";import destroyObject from"../../Core/destroyObject.js";import knockout from"../../ThirdParty/knockout.js";import getElement from"../getElement.js";import InspectorShared from"../InspectorShared.js";import Cesium3DTilesInspectorViewModel from"./Cesium3DTilesInspectorViewModel.js";function Cesium3DTilesInspector(e,t){Check.defined("container",e),Check.typeOf.object("scene",t),e=getElement(e);const i=document.createElement("div"),n=document.createElement("div");n.setAttribute("data-bind","visible: performance");const s=new Cesium3DTilesInspectorViewModel(t,n);this._viewModel=s,this._container=e,this._element=i;const a=document.createElement("div");a.textContent="3D Tiles Inspector",a.className="cesium-cesiumInspector-button",a.setAttribute("data-bind","click: toggleInspector"),i.appendChild(a),i.className="cesium-cesiumInspector cesium-3DTilesInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(i);const d=document.createElement("div");this._panel=d,d.className="cesium-cesiumInspector-dropDown",i.appendChild(d);const o=InspectorShared.createSection,c=InspectorShared.createCheckbox,r=o(d,"Tileset","tilesetVisible","toggleTileset"),l=o(d,"Display","displayVisible","toggleDisplay"),p=o(d,"Update","updateVisible","toggleUpdate"),m=o(d,"Logging","loggingVisible","toggleLogging"),u=o(d,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),h=o(d,"Style","styleVisible","toggleStyle"),C=o(d,"Optimization","optimizationVisible","toggleOptimization"),b=document.createElement("div");b.className="field-group";const g=document.createElement("label");g.className="field-label",g.appendChild(document.createTextNode("Properties: "));const S=document.createElement("div");S.setAttribute("data-bind","text: properties"),b.appendChild(g),b.appendChild(S),r.appendChild(b),r.appendChild(makeButton("togglePickTileset","Pick Tileset","pickActive")),r.appendChild(makeButton("trimTilesCache","Trim Tiles Cache")),r.appendChild(c("Enable Picking","picking")),l.appendChild(c("Colorize","colorize")),l.appendChild(c("Wireframe","wireframe","_tileset === undefined || hasEnabledWireframe"));const E=document.createElement("p");E.setAttribute("data-bind","visible: _tileset !== undefined && !hasEnabledWireframe"),E.setAttribute("class","cesium-3DTilesInspector-disabledElementsInfo"),E.innerText="Set enableDebugWireframe to true in the tileset constructor to enable this option.",l.lastChild.appendChild(E),l.appendChild(c("Bounding Volumes","showBoundingVolumes")),l.appendChild(c("Content Volumes","showContentBoundingVolumes")),l.appendChild(c("Request Volumes","showRequestVolumes")),l.appendChild(c("Point Cloud Shading","pointCloudShading"));const k=document.createElement("div");k.setAttribute("data-bind","visible: pointCloudShading"),k.appendChild(makeRangeInput("geometricErrorScale",0,2,.01,"Geometric Error Scale")),k.appendChild(makeRangeInput("maximumAttenuation",0,32,1,"Maximum Attenuation")),k.appendChild(makeRangeInput("baseResolution",0,1,.01,"Base Resolution")),k.appendChild(c("Eye Dome Lighting (EDL)","eyeDomeLighting")),l.appendChild(k);const y=document.createElement("div");y.setAttribute("data-bind","visible: eyeDomeLighting"),y.appendChild(makeRangeInput("eyeDomeLightingStrength",0,2,.1,"EDL Strength")),y.appendChild(makeRangeInput("eyeDomeLightingRadius",0,4,.1,"EDL Radius")),k.appendChild(y),p.appendChild(c("Freeze Frame","freezeFrame")),p.appendChild(c("Dynamic Screen Space Error","dynamicScreenSpaceError"));const v=document.createElement("div");v.appendChild(makeRangeInput("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error")),p.appendChild(v);const f=document.createElement("div");f.setAttribute("data-bind","visible: dynamicScreenSpaceError"),f.appendChild(makeRangeInput("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity")),f.appendChild(makeRangeInput("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor")),p.appendChild(f),m.appendChild(c("Performance","performance")),m.appendChild(n),m.appendChild(c("Statistics","showStatistics"));const I=document.createElement("div");I.className="cesium-3dTilesInspector-statistics",I.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),m.appendChild(I),m.appendChild(c("Pick Statistics","showPickStatistics"));const D=document.createElement("div");D.className="cesium-3dTilesInspector-statistics",D.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),m.appendChild(D),m.appendChild(c("Resource Cache Statistics","showResourceCacheStatistics"));const T=document.createElement("div");T.className="cesium-3dTilesInspector-statistics",T.setAttribute("data-bind","html: resourceCacheStatisticsText, visible: showResourceCacheStatistics"),m.appendChild(T);const w=document.createElement("div");h.appendChild(w),w.appendChild(document.createTextNode("Color Blend Mode: "));const x=document.createElement("select");x.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),w.appendChild(x);const R=document.createElement("textarea");R.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),w.className="cesium-cesiumInspector-styleEditor",w.appendChild(R);const V=makeButton("compileStyle","Compile (Ctrl+Enter)");w.appendChild(V);const L=document.createElement("div");L.className="cesium-cesiumInspector-error",L.setAttribute("data-bind","text: editorError"),w.appendChild(L),u.appendChild(c("Show Picked Only","showOnlyPickedTileDebugLabel")),u.appendChild(c("Geometric Error","showGeometricError")),u.appendChild(c("Rendering Statistics","showRenderingStatistics")),u.appendChild(c("Memory Usage (MB)","showMemoryUsage")),u.appendChild(c("Url","showUrl")),C.appendChild(c("Skip Tile LODs","skipLevelOfDetail"));const A=document.createElement("div");A.appendChild(makeRangeInput("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor")),C.appendChild(A);const M=document.createElement("div");M.appendChild(makeRangeInput("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD")),C.appendChild(M);const N=document.createElement("div");N.appendChild(makeRangeInput("skipLevels",0,10,1,"Min. levels to skip")),C.appendChild(N),C.appendChild(c("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),C.appendChild(c("Load siblings of visible tiles","loadSiblings")),knockout.applyBindings(s,i)}function makeRangeInput(e,t,i,n,s,a){a=defaultValue(a,e);const d=document.createElement("input");d.setAttribute("data-bind",`value: ${a}`),d.type="number";const o=document.createElement("input");o.type="range",o.min=t,o.max=i,o.step=n,o.setAttribute("data-bind",`valueUpdate: "input", value: ${e}`);const c=document.createElement("div");c.appendChild(o);const r=document.createElement("div");return r.className="cesium-cesiumInspector-slider",r.appendChild(document.createTextNode(s)),r.appendChild(d),r.appendChild(c),r}function makeButton(e,t,i){const n=document.createElement("button");n.type="button",n.textContent=t,n.className="cesium-cesiumInspector-pickButton";let s=`click: ${e}`;return defined(i)&&(s+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${i}}`),n.setAttribute("data-bind",s),n}Object.defineProperties(Cesium3DTilesInspector.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),Cesium3DTilesInspector.prototype.isDestroyed=function(){return!1},Cesium3DTilesInspector.prototype.destroy=function(){return knockout.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),destroyObject(this)};export default Cesium3DTilesInspector;